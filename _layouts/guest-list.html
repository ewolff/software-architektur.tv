---
layout: default
---

<div class="guest-list-container">
  <!-- Filter and Search Controls -->
  <div class="guest-controls">
    <div class="search-container">
      <input type="text" id="guest-search" placeholder="Person suchen..." class="search-input">
      <span class="search-icon">üîç</span>
    </div>
    
    <div class="filter-container">
      <select id="tag-filter" class="filter-select">
        <option value="">Alle Tags</option>
        <!-- Tags werden dynamisch gef√ºllt -->
      </select>
    </div>
    
    <div class="sort-container">
      <select id="guest-sort" class="sort-select">
        <option value="name">Alphabetisch</option>
        <option value="episodes">Nach Auftritten</option>
        <option value="recent">Zuletzt aufgetreten</option>
      </select>
    </div>
    
    <div class="results-info">
      <span id="guest-count"></span>
    </div>
  </div>

  <!-- All Persons Section (Guests + Moderators) -->
  <section class="guests-section">
    <div class="guest-grid" id="guest-grid">
      <!-- Moderators first -->
      {% for moderator in site.data.guests.moderators %}
        <article class="guest-card moderator-card" 
                 data-name="{{ moderator.name | downcase }}"
                 data-tags="{{ moderator.tags | join: ',' | downcase }}"
                 data-episodes="{% if moderator.solo_episodes_count %}{{ moderator.solo_episodes_count | plus: moderator.episodes.size }}{% else %}{{ moderator.episodes.size }}{% endif %}"
                 data-recent="{{ moderator.episodes.last.date }}"
                 data-type="moderator">
          
          <!-- Avatar -->
          <div class="guest-avatar">
            <div class="avatar-placeholder">
              <span class="avatar-initials">{{ moderator.name | split: ' ' | map: 'first' | join }}</span>
            </div>
            <div class="moderator-badge">üéôÔ∏è</div>
          </div>
          
          <!-- Info -->
          <div class="guest-info">
            <h3 class="guest-name">{{ moderator.name }}</h3>
            
            <!-- Tags -->
            <div class="guest-tags">
              {% for tag in moderator.tags limit:3 %}
                <span class="tag">{{ tag }}</span>
              {% endfor %}
            </div>
            
            <!-- Episode Stats -->
            <div class="episode-stats">
              {% if moderator.solo_episodes_count %}
                <span class="episode-count">{{ moderator.solo_episodes_count }} Solo + {{ moderator.episodes.size }} Co-Mod</span>
              {% else %}
                <span class="episode-count">{{ moderator.episodes.size }} Auftritte</span>
              {% endif %}
            </div>
          </div>
          
          <!-- Episodes List -->
          <div class="episodes-section">
            {% assign total_episodes = moderator.episodes.size %}
            {% if moderator.solo_episodes_count %}
              {% assign total_episodes = moderator.solo_episodes_count | plus: moderator.episodes.size %}
            {% endif %}
            
            {% if total_episodes <= 2 %}
              <!-- Direct episode display for 1-2 episodes -->
              <div class="episodes-list-direct">
                {% if moderator.solo_episodes_count %}
                  <div class="episode-item">
                    <span class="episode-title">{{ moderator.solo_episodes_count }} Solo-Episoden</span>
                  </div>
                {% endif %}
                {% for episode in moderator.episodes %}
                  <div class="episode-item">
                    <a href="{{ episode.url }}" class="episode-link">
                      <span class="episode-title">{{ episode.title | truncate: 60 }}</span>
                      <span class="episode-date">{{ episode.date | date: "%d.%m.%Y" }}</span>
                    </a>
                  </div>
                {% endfor %}
              </div>
            {% else %}
              <!-- Button for 3+ episodes -->
              <button class="episodes-toggle" onclick="toggleEpisodes(this)">
                <span class="toggle-text">Episoden anzeigen</span>
                <span class="toggle-icon">‚ñº</span>
              </button>
              
              <div class="episodes-list" style="display: none;">
                {% if moderator.solo_episodes_count %}
                  <div class="episode-group">
                    <h4>Als Hauptmoderator</h4>
                    <p class="solo-episodes-note">{{ moderator.solo_episodes_count }} Solo-Episoden</p>
                  </div>
                {% endif %}
                
                {% if moderator.episodes.size > 0 %}
                  <div class="episode-group">
                    <h4>Als Co-Moderator/Gast</h4>
                    <div class="episode-list-scrollable {% if moderator.episodes.size > 5 %}scrollable{% endif %}">
                      {% for episode in moderator.episodes %}
                        <div class="episode-item">
                          <a href="{{ episode.url }}" class="episode-link">
                            <span class="episode-title">{{ episode.title | truncate: 80 }}</span>
                            <span class="episode-date">{{ episode.date | date: "%d.%m.%Y" }}</span>
                          </a>
                        </div>
                      {% endfor %}
                    </div>
                  </div>
                {% endif %}
              </div>
            {% endif %}
          </div>
        </article>
      {% endfor %}

      <!-- Then regular guests -->
      {% for guest in site.data.guests.guests %}
        <article class="guest-card" 
                 data-name="{{ guest.name | downcase }}"
                 data-tags="{{ guest.tags | join: ',' | downcase }}"
                 data-episodes="{{ guest.episodes.size }}"
                 data-recent="{{ guest.episodes.last.date }}"
                 data-type="guest">
          
          <!-- Avatar -->
          <div class="guest-avatar">
            <div class="avatar-placeholder">
              <span class="avatar-initials">{{ guest.name | split: ' ' | map: 'first' | join }}</span>
            </div>
            {% if guest.episodes.size > 3 %}
              <div class="frequent-guest-badge">‚≠ê</div>
            {% endif %}
          </div>
          
          <!-- Info -->
          <div class="guest-info">
            <h3 class="guest-name">{{ guest.name }}</h3>
            
            <!-- Tags -->
            <div class="guest-tags">
              {% for tag in guest.tags limit:3 %}
                <span class="tag">{{ tag }}</span>
              {% endfor %}
            </div>
            
            <!-- Episode Count -->
            <div class="episode-stats">
              <span class="episode-count">{{ guest.episodes.size }} Episode{% if guest.episodes.size != 1 %}n{% endif %}</span>
            </div>
          </div>
          
          <!-- Episodes List -->
          <div class="episodes-section">
            {% if guest.episodes.size <= 2 %}
              <!-- Direct episode display for 1-2 episodes -->
              <div class="episodes-list-direct">
                {% for episode in guest.episodes %}
                  <div class="episode-item">
                    <a href="{{ episode.url }}" class="episode-link">
                      <span class="episode-title">{{ episode.title | truncate: 60 }}</span>
                      <span class="episode-date">{{ episode.date | date: "%d.%m.%Y" }}</span>
                    </a>
                  </div>
                {% endfor %}
              </div>
            {% else %}
              <!-- Button for 3+ episodes -->
              <button class="episodes-toggle" onclick="toggleEpisodes(this)">
                <span class="toggle-text">Episoden anzeigen</span>
                <span class="toggle-icon">‚ñº</span>
              </button>
              
              <div class="episodes-list" style="display: none;">
                <div class="episode-list-scrollable {% if guest.episodes.size > 5 %}scrollable{% endif %}">
                  {% for episode in guest.episodes %}
                    <div class="episode-item">
                      <a href="{{ episode.url }}" class="episode-link">
                        <span class="episode-title">{{ episode.title | truncate: 80 }}</span>
                        <span class="episode-date">{{ episode.date | date: "%d.%m.%Y" }}</span>
                      </a>
                    </div>
                  {% endfor %}
                </div>
              </div>
            {% endif %}
          </div>
        </article>
      {% endfor %}
    </div>
  </section>
</div>

<!-- JavaScript for filtering, searching and episode toggling -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.getElementById('guest-search');
  const tagFilter = document.getElementById('tag-filter');
  const sortSelect = document.getElementById('guest-sort');
  const guestCards = document.querySelectorAll('.guest-card');
  const guestCount = document.getElementById('guest-count');
  
  // Collect all unique tags
  const allTags = new Set();
  guestCards.forEach(card => {
    const tags = card.dataset.tags.split(',').filter(tag => tag.trim());
    tags.forEach(tag => allTags.add(tag.trim()));
  });
  
  // Populate tag filter
  Array.from(allTags).sort().forEach(tag => {
    const option = document.createElement('option');
    option.value = tag;
    option.textContent = tag.charAt(0).toUpperCase() + tag.slice(1);
    tagFilter.appendChild(option);
  });
  
  function filterAndSort() {
    const searchTerm = searchInput.value.toLowerCase();
    const selectedTag = tagFilter.value.toLowerCase();
    const sortBy = sortSelect.value;
    
    let visibleCards = Array.from(guestCards).filter(card => {
      const name = card.dataset.name;
      const cardTags = card.dataset.tags.split(',').map(tag => tag.trim());
      
      const matchesSearch = name.includes(searchTerm);
      const matchesTag = !selectedTag || cardTags.includes(selectedTag);
      
      return matchesSearch && matchesTag;
    });
    
    // Sort visible cards
    visibleCards.sort((a, b) => {
      if (sortBy === 'episodes') {
        return parseInt(b.dataset.episodes) - parseInt(a.dataset.episodes);
      } else if (sortBy === 'recent') {
        return new Date(b.dataset.recent) - new Date(a.dataset.recent);
      } else {
        return a.dataset.name.localeCompare(b.dataset.name);
      }
    });
    
    // Hide all cards first
    guestCards.forEach(card => {
      card.style.display = 'none';
    });
    
    // Show and reorder visible cards
    const guestGrid = document.getElementById('guest-grid');
    visibleCards.forEach((card, index) => {
      card.style.display = '';
      guestGrid.appendChild(card);
    });
    
    // Update count
    guestCount.textContent = `${visibleCards.length} Person${visibleCards.length !== 1 ? 'en' : ''} gefunden`;
  }
  
  // Event listeners
  searchInput.addEventListener('input', filterAndSort);
  tagFilter.addEventListener('change', filterAndSort);
  sortSelect.addEventListener('change', filterAndSort);
  
  // Initial filter
  filterAndSort();
});

// Toggle episodes function
function toggleEpisodes(button) {
  const episodesList = button.nextElementSibling;
  const toggleIcon = button.querySelector('.toggle-icon');
  const toggleText = button.querySelector('.toggle-text');
  
  if (episodesList.style.display === 'none') {
    episodesList.style.display = 'block';
    toggleIcon.textContent = '‚ñ≤';
    toggleText.textContent = 'Episoden verbergen';
    button.classList.add('expanded');
  } else {
    episodesList.style.display = 'none';
    toggleIcon.textContent = '‚ñº';
    toggleText.textContent = 'Episoden anzeigen';
    button.classList.remove('expanded');
  }
}
</script>